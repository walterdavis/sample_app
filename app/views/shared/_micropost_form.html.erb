<%= form_for(@micropost) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="field">
    <%= f.text_area :content, placeholder: "Compose new micropost..." %>
    <output class="pull-right" id="countdown">140</output>
  </div>
  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %>
<script type="text/javascript" charset="utf-8">
(function(){
  var input = document.getElementById('micropost_content');
  var output = document.getElementById('countdown'), limit = output.value;
  setInterval(function(){
    var l = input.value.length;
    if(l <= limit) {
      input.parentNode.classList.remove('field_with_errors');
      output.classList.remove('too-long');
    }else{
      input.parentNode.classList.add('field_with_errors');
      output.classList.add('too-long');
    }
    output.value = limit - l;
  },20);
})();
</script>